import{j as e,T as t,S as s}from"./tactical-components-ecb51026.js";import{r as a}from"./react-vendor-e58626de.js";import{L as i,M as r,T as l,d,b as n,a as c}from"./map-vendor-95ccbafd.js";/* empty css                */import{F as o,E as m,W as x,g as h,e as g,h as u,i as p,j,U as y,A as b,C as v,D as N,S as f}from"./ui-vendor-b7f86872.js";import{R as w,B as S,C as A,X as M,Y as P,T as C,a as z,P as F,b as I,c as D}from"./chart-vendor-bdde4f4f.js";delete i.Icon.Default.prototype._getIconUrl,i.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const R=({monitoringZones:t,activeAlerts:s,onAlertSelect:o})=>{const m=a.useRef(null),x=e=>{switch(e){case"critical":return"#dc2626";case"high":return"#ea580c";case"medium":return"#d97706";case"low":return"#65a30d";default:return"#6b7280"}},h=e=>{const t=e.analysis?.magnitudeScore||0,s=t>=80?"#dc2626":t>=60?"#ea580c":t>=40?"#d97706":"#65a30d";return i.divIcon({html:`<div style="background-color: ${s}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>`,iconSize:[20,20],className:"custom-fire-icon"})};return e.jsxs("div",{style:{height:"500px",width:"100%"},className:"rounded-lg overflow-hidden",children:[e.jsxs(r,{center:(()=>{if(0===t.length)return[40.4168,-3.7038];return[t.reduce((e,t)=>e+t.center.latitude,0)/t.length,t.reduce((e,t)=>e+t.center.longitude,0)/t.length]})(),zoom:10,style:{height:"100%",width:"100%"},ref:m,children:[e.jsx(l,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.map(t=>{const s=t.polygon.map(e=>[e.latitude,e.longitude]);return e.jsx(d,{positions:s,pathOptions:{color:x(t.priority),weight:2,opacity:.8,fillOpacity:.1},children:e.jsx(n,{children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsxs("p",{className:"text-sm",children:["Priority: ",t.priority]}),e.jsxs("p",{className:"text-sm",children:["Area: ",t.area.toFixed(2)," kmÂ²"]})]})})},t.id)}),s.map(t=>e.jsx(c,{position:[t.fireData.location.latitude,t.fireData.location.longitude],icon:h(t),eventHandlers:{click:()=>o(t)},children:e.jsx(n,{children:e.jsxs("div",{className:"p-2 min-w-[200px]",children:[e.jsx("h3",{className:"font-semibold text-red-600 mb-2",children:"ðŸ”¥ Active Fire"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Zone:"})," ",t.zone.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Detection:"})," ",new Date(t.fireData.detectionTime).toLocaleTimeString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Satellite:"})," ",t.fireData.satellite]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Confidence:"})," ",t.fireData.confidence,"%"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Brightness:"})," ",t.fireData.brightness,"K"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Size:"})," ",t.fireData.size.toFixed(1)," ha"]}),"ready"===t.status&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Magnitude:"})," ",t.analysis.magnitudeScore,"/100"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Danger:"})," ",t.analysis.dangerScore,"/100"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Spread:"})," ",t.analysis.spreadPrediction.speed.toFixed(1)," km/h"]})]}),"analyzing"===t.status&&e.jsx("div",{className:"text-yellow-600 font-medium",children:"ðŸ¤– Analyzing with Azure AI..."})]})]})})},t.id))]}),e.jsxs("div",{className:"absolute top-4 right-4 bg-white bg-opacity-95 p-3 rounded-lg shadow-lg z-[1000]",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Legend"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-red-600 bg-red-600 bg-opacity-20"}),e.jsx("span",{children:"Critical Zone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-orange-600 bg-orange-600 bg-opacity-20"}),e.jsx("span",{children:"High Zone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-yellow-600 bg-yellow-600 bg-opacity-20"}),e.jsx("span",{children:"Medium Zone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-green-600 bg-green-600 bg-opacity-20"}),e.jsx("span",{children:"Low Zone"})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),e.jsx("span",{children:"Active Fire"})]})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-white bg-opacity-95 p-3 rounded-lg shadow-lg z-[1000]",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"ðŸ›°ï¸ Satellite Data"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"VIIRS:"})," Night detection"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"MODIS:"})," Thermal monitoring"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Sentinel-2:"})," Optical analysis"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Landsat:"})," Vegetation indices"]})]})]})]})},k=({alert:t})=>{const[s,i]=a.useState("overview"),{analysis:r,fireData:l}=t,d=[{name:"Satellite Brightness",value:Math.min(40,(l.brightness-300)/10),max:40},{name:"Fire Size",value:Math.min(30,5*l.size),max:30},{name:"Weather Conditions",value:15,max:20},{name:"Vegetation Dryness",value:8,max:10}],n=[{time:"1h",area:5},{time:"6h",area:25},{time:"12h",area:65},{time:"24h",area:r.spreadPrediction.area24h},{time:"48h",area:.7*r.spreadPrediction.area72h},{time:"72h",area:r.spreadPrediction.area72h}],c=[{name:"Residential",value:35,color:"#ef4444"},{name:"Agricultural",value:25,color:"#f59e0b"},{name:"Forest",value:30,color:"#10b981"},{name:"Industrial",value:10,color:"#6366f1"}],j=(y=r.magnitudeScore)>=80?{level:"Extreme",color:"text-red-600",bgColor:"bg-red-100"}:y>=60?{level:"High",color:"text-orange-600",bgColor:"bg-orange-100"}:y>=40?{level:"Medium",color:"text-yellow-600",bgColor:"bg-yellow-100"}:{level:"Low",color:"text-green-600",bgColor:"bg-green-100"};var y;const b=(e=>e>=80?{level:"Critical",color:"text-red-600",bgColor:"bg-red-100"}:e>=60?{level:"High",color:"text-orange-600",bgColor:"bg-orange-100"}:e>=40?{level:"Medium",color:"text-yellow-600",bgColor:"bg-yellow-100"}:{level:"Low",color:"text-green-600",bgColor:"bg-green-100"})(r.dangerScore),v=[{id:"overview",label:"Summary",icon:o},{id:"spread",label:"Spread",icon:x},{id:"impact",label:"Impact",icon:p}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 md:p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 md:mb-6 flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 md:h-6 md:w-6 text-red-600"}),"Comprehensive Fire Analysis - ",t.zone.name]}),e.jsx("div",{className:"border-b border-gray-200 mb-4 md:mb-6 overflow-x-auto",children:e.jsx("nav",{className:"-mb-px flex space-x-4 md:space-x-8",children:v.map(t=>{const a=t.icon;return e.jsxs("button",{onClick:()=>i(t.id),className:"flex items-center gap-1 md:gap-2 py-2 px-1 border-b-2 font-medium text-xs md:text-sm whitespace-nowrap "+(s===t.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(a,{className:"h-3 w-3 md:h-4 md:w-4"}),t.label]},t.id)})})}),"overview"===s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[e.jsxs("div",{className:`p-3 md:p-4 rounded-lg border ${j.bgColor}`,children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(o,{className:"h-4 w-4 md:h-5 md:w-5 text-red-600"}),e.jsx("span",{className:"font-semibold text-sm md:text-base text-gray-900",children:"Magnitude"})]}),e.jsxs("div",{className:`text-xl md:text-2xl font-bold ${j.color}`,children:[r.magnitudeScore.toFixed(2),"/100"]}),e.jsx("div",{className:`text-xs md:text-sm font-medium ${j.color}`,children:j.level})]}),e.jsxs("div",{className:`p-3 md:p-4 rounded-lg border ${b.bgColor}`,children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(m,{className:"h-4 w-4 md:h-5 md:w-5 text-orange-600"}),e.jsx("span",{className:"font-semibold text-sm md:text-base text-gray-900",children:"Danger"})]}),e.jsxs("div",{className:`text-xl md:text-2xl font-bold ${b.color}`,children:[r.dangerScore.toFixed(2),"/100"]}),e.jsx("div",{className:`text-xs md:text-sm font-medium ${b.color}`,children:b.level})]}),e.jsxs("div",{className:"p-3 md:p-4 rounded-lg border bg-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(x,{className:"h-4 w-4 md:h-5 md:w-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-sm md:text-base text-gray-900",children:"Speed"})]}),e.jsxs("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:[r.spreadPrediction.speed.toFixed(2)," km/h"]}),e.jsxs("div",{className:"text-xs md:text-sm font-medium text-blue-600",children:["Direction: ",r.spreadPrediction.direction.toFixed(2),"Â°"]})]}),e.jsxs("div",{className:"p-3 md:p-4 rounded-lg border bg-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(h,{className:"h-4 w-4 md:h-5 md:w-5 text-purple-600"}),e.jsx("span",{className:"font-semibold text-sm md:text-base text-gray-900",children:"Confidence"})]}),e.jsxs("div",{className:"text-xl md:text-2xl font-bold text-purple-600",children:[Math.round(100*r.dataQuality.overallConfidence),"%"]}),e.jsx("div",{className:"text-xs md:text-sm font-medium text-purple-600",children:"Azure AI"})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg bg-red-50 mb-4 md:mb-6",children:[e.jsxs("h3",{className:"font-semibold text-red-900 mb-2 flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 md:h-5 md:w-5 text-red-600"}),"Fire Location"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-red-800 font-medium text-sm",children:"Latitude:"}),e.jsx("p",{className:"text-red-700 text-sm",children:l.location.latitude.toFixed(6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-red-800 font-medium text-sm",children:"Longitude:"}),e.jsx("p",{className:"text-red-700 text-sm",children:l.location.longitude.toFixed(6)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 mb-6",children:[e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 md:mb-4 text-sm md:text-base",children:"Fire Magnitude Breakdown"}),e.jsx("div",{style:{height:"180px"},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(S,{data:d,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"name",tick:{fontSize:10}}),e.jsx(P,{tick:{fontSize:10}}),e.jsx(C,{}),e.jsx(z,{dataKey:"value",fill:"#dc2626"})]})})}),e.jsxs("div",{className:"mt-2 text-xs md:text-sm text-gray-600",children:[e.jsx("strong",{children:"Total:"})," ",r.magnitudeScore.toFixed(2),"/100 points"]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 md:mb-4 text-sm md:text-base",children:"Danger Level Breakdown"}),e.jsx("div",{style:{height:"180px"},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(S,{data:[{name:"Population",value:35,max:40},{name:"Infrastructure",value:25,max:30},{name:"Economic Value",value:18,max:20},{name:"Environmental Value",value:7,max:10}],children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"name",tick:{fontSize:10}}),e.jsx(P,{tick:{fontSize:10}}),e.jsx(C,{}),e.jsx(z,{dataKey:"value",fill:"#ea580c"})]})})}),e.jsxs("div",{className:"mt-2 text-xs md:text-sm text-gray-600",children:[e.jsx("strong",{children:"Total:"})," ",r.dangerScore.toFixed(2),"/100 points"]})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg bg-blue-50",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2 md:mb-3 text-sm md:text-base",children:"ðŸ›°ï¸ Satellite Data Quality"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base md:text-lg font-bold text-blue-600",children:[Math.round(100*r.dataQuality.satelliteData),"%"]}),e.jsx("div",{className:"text-xs md:text-sm text-blue-700",children:"Satellite Data"}),e.jsx("div",{className:"text-xs text-blue-600",children:"VIIRS + MODIS"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base md:text-lg font-bold text-blue-600",children:[Math.round(100*r.dataQuality.weatherData),"%"]}),e.jsx("div",{className:"text-xs md:text-sm text-blue-700",children:"Weather Data"}),e.jsx("div",{className:"text-xs text-blue-600",children:"Azure Weather"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base md:text-lg font-bold text-blue-600",children:[Math.round(100*r.dataQuality.infrastructureData),"%"]}),e.jsx("div",{className:"text-xs md:text-sm text-blue-700",children:"Infrastructure"}),e.jsx("div",{className:"text-xs text-blue-600",children:"OpenStreetMap"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-base md:text-lg font-bold text-blue-600",children:[Math.round(100*r.dataQuality.overallConfidence),"%"]}),e.jsx("div",{className:"text-xs md:text-sm text-blue-700",children:"Total Confidence"}),e.jsx("div",{className:"text-xs text-blue-600",children:"Azure AI"})]})]})]})]}),"spread"===s&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 md:mb-4 text-sm md:text-base",children:"Spread Prediction (Machine Learning)"}),e.jsx("div",{style:{height:"200px"},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(S,{data:n,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"time",tick:{fontSize:10}}),e.jsx(P,{label:{value:"Area (ha)",angle:-90,position:"insideLeft",fontSize:10},tick:{fontSize:10}}),e.jsx(C,{formatter:e=>[`${e} ha`,"Affected Area"]}),e.jsx(z,{dataKey:"area",fill:"#3b82f6"})]})})}),e.jsxs("div",{className:"mt-2 text-xs md:text-sm text-gray-600",children:[e.jsx("strong",{children:"Prediction based on:"})," Rothermel Model + Azure Machine Learning + Weather data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-2 md:mb-3",children:[e.jsx(x,{className:"h-4 w-4 md:h-5 md:w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Wind Factors"})]}),e.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Speed:"}),e.jsxs("span",{className:"font-medium",children:[r.spreadPrediction.speed.toFixed(2)," km/h"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Direction:"}),e.jsxs("span",{className:"font-medium",children:[r.spreadPrediction.direction.toFixed(2),"Â° (",E(r.spreadPrediction.direction),")"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Gusts:"}),e.jsxs("span",{className:"font-medium",children:[(1.3*r.spreadPrediction.speed).toFixed(2)," km/h"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Stability:"}),e.jsx("span",{className:"font-medium",children:"Unstable"})]})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-2 md:mb-3",children:[e.jsx(u,{className:"h-4 w-4 md:h-5 md:w-5 text-orange-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Environmental Factors"})]}),e.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Temperature:"}),e.jsx("span",{className:"font-medium",children:"32Â°C"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Humidity:"}),e.jsx("span",{className:"font-medium",children:"25%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Vegetation dryness:"}),e.jsx("span",{className:"font-medium",children:"78%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"NDVI Index:"}),e.jsx("span",{className:"font-medium",children:"0.32"})]})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-2 md:mb-3",children:[e.jsx(g,{className:"h-4 w-4 md:h-5 md:w-5 text-purple-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Topographic Factors"})]}),e.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Slope:"}),e.jsx("span",{className:"font-medium",children:"15%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Aspect:"}),e.jsx("span",{className:"font-medium",children:"South"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Elevation:"}),e.jsx("span",{className:"font-medium",children:"450m"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Accessibility:"}),e.jsx("span",{className:"font-medium",children:"Moderate"})]})]})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 md:mb-4 text-sm md:text-base",children:"Critical Spread Points"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Fire Head"}),e.jsx("span",{className:"text-xs font-medium bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"CRITICAL"})]}),e.jsxs("p",{className:"text-xs md:text-sm text-red-700",children:["Main advance in ",E(r.spreadPrediction.direction)," direction at ",r.spreadPrediction.speed.toFixed(2)," km/h. Maximum priority for containment."]})]}),e.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium text-orange-800 text-sm",children:"Right Flank"}),e.jsx("span",{className:"text-xs font-medium bg-orange-100 text-orange-800 px-2 py-1 rounded-full",children:"HIGH"})]}),e.jsx("p",{className:"text-xs md:text-sm text-orange-700",children:"Lateral spread with potential for opening. Risk of affecting residential area in 3-4 hours."})]})]})]})]}),"impact"===s&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(p,{className:"h-4 w-4 md:h-5 md:w-5 text-red-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Population"})]}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-red-600",children:"2,450"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"People at risk"})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(p,{className:"h-4 w-4 md:h-5 md:w-5 text-orange-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Structures"})]}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-orange-600",children:"185"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Buildings threatened"})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(p,{className:"h-4 w-4 md:h-5 md:w-5 text-green-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Area"})]}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:r.spreadPrediction.area72h.toFixed(2)}),e.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Potential hectares"})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 mb-1 md:mb-2",children:[e.jsx(p,{className:"h-4 w-4 md:h-5 md:w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Infrastructure"})]}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:"12"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Critical facilities"})]})]}),e.jsxs("div",{className:"p-3 md:p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 md:mb-4 text-sm md:text-base",children:"Land Use Impact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsx("div",{style:{height:"200px"},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(F,{children:[e.jsx(I,{data:c,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,children:c.map((t,s)=>e.jsx(D,{fill:t.color},`cell-${s}`))}),e.jsx(C,{})]})})}),e.jsxs("div",{className:"space-y-2 md:space-y-3",children:[e.jsxs("div",{className:"p-2 md:p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Residential Area"}),e.jsx("p",{className:"text-xs md:text-sm text-red-700 mt-1",children:"35% of affected area. Includes 3 urban developments with approximately 2,450 residents."})]}),e.jsxs("div",{className:"p-2 md:p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("h4",{className:"font-medium text-yellow-800 text-sm",children:"Agricultural Area"}),e.jsx("p",{className:"text-xs md:text-sm text-yellow-700 mt-1",children:"25% of affected area. Dryland and irrigated crops with estimated economic value of â‚¬1.2M."})]})]})]})]})]}),e.jsxs("div",{className:"mt-4 md:mt-6 p-3 md:p-4 bg-gray-50 rounded-lg text-xs md:text-sm",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-xs md:text-sm",children:"ðŸš€ Azure Services Used:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1 md:gap-2 text-gray-700",children:[e.jsx("div",{children:"âœ“ Azure ML"}),e.jsx("div",{children:"âœ“ Cognitive Services"}),e.jsx("div",{children:"âœ“ Azure Maps"}),e.jsx("div",{children:"âœ“ Azure Functions"})]})]})]})};function E(e){return["N","NE","E","SE","S","SW","W","NW"][Math.round(e/45)%8]}const _=({alert:i,organization:r})=>{const[l,d]=a.useState("map"),[n,c]=a.useState(void 0),{tacticalPlan:o}=i.analysis;a.useEffect(()=>{if(navigator.geolocation){const e=navigator.geolocation.watchPosition(e=>{c({latitude:e.coords.latitude,longitude:e.coords.longitude})},e=>{switch(e.code){case e.PERMISSION_DENIED:case e.POSITION_UNAVAILABLE:case e.TIMEOUT:}m()},{enableHighAccuracy:!0,maximumAge:3e4,timeout:15e3});return()=>navigator.geolocation.clearWatch(e)}m()},[]);const m=()=>{const e=i.fireData.location;c({latitude:e.latitude-.01,longitude:e.longitude-.01});let t=0;const s=setInterval(()=>{t+=1,c(e=>e?{latitude:e.latitude+5e-4,longitude:e.longitude+5e-4}:e),t>20&&clearInterval(s)},1e4);return()=>clearInterval(s)},x=e=>{switch(e){case"firefighters":return"Fire Department";case"medical":return"Medical Services";case"police":return"Law Enforcement";case"civil_protection":return"Civil Protection";default:return"Emergency Organization"}},h=e=>{switch(e){case"easy":return"text-green-600 bg-green-100";case"moderate":return"text-yellow-600 bg-yellow-100";case"difficult":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},u=e=>{if("number"==typeof e)return e>=9?"text-red-600 bg-red-100":e>=7?"text-orange-600 bg-orange-100":e>=5?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";switch(e){case"immediate":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},w=e=>{switch(e){case"excellent":return"text-green-600";case"good":return"text-blue-600";case"difficult":return"text-orange-600";case"extreme":return"text-red-600";default:return"text-gray-600"}},S=[{id:"map",label:"Tactical Map",icon:g},{id:"overview",label:"Summary",icon:p},{id:"details",label:"Details",icon:j},{id:"resources",label:"Resources",icon:N}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(p,{className:"h-6 w-6 text-blue-600"}),"Tactical Plan - ",x(r.type)]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:(e=>{switch(e){case"firefighters":return"ðŸš’";case"medical":return"ðŸš‘";case"police":return"ðŸ‘®";case"civil_protection":return"ðŸ›¡ï¸";default:return"ðŸš¨"}})(r.type)}),e.jsx("span",{children:r.name})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Main Strategy"}),e.jsx("p",{className:"text-blue-800",children:o.primaryStrategy})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:S.map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>d(t.id),className:"flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm "+(l===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(s,{className:"h-4 w-4"}),t.label]},t.id)})})}),"map"===l&&e.jsx(t,{alert:i,organization:r,userLocation:n}),"overview"===l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[e.jsx(j,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.entryRoutes.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Entry Routes"})]}),e.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[e.jsx(y,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.evacuationRoutes.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Evacuation Routes"})]}),e.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[e.jsx(b,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o.criticalZones.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Critical Zones"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Identified Water Resources"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:o.waterSources.length}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Total capacity: ",o.waterSources.reduce((e,t)=>e+t.capacity,0).toLocaleString()," L"]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Identified Civilian Areas"}),e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:o.civilianAreas.length}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Total population: ",o.civilianAreas.reduce((e,t)=>e+t.population,0).toLocaleString()," people"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed Strategy"}),e.jsx(s,{strategy:o.primaryStrategy,organizationType:r.type})]})]}),"details"===l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-blue-600"}),"Entry Routes"]}),e.jsx("div",{className:"space-y-3",children:o.entryRoutes.map((t,s)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Entry Route ",s+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h(t.difficulty)}`,children:t.difficulty.toUpperCase()}),e.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),t.estimatedTime," min"]})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg mb-3",children:[e.jsx("h5",{className:"font-medium text-blue-800 mb-1",children:"Navigation Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"Start from designated meeting point"}),e.jsx("li",{children:"Follow the blue route marked on the map"}),e.jsx("li",{children:"Maintain constant communication with command center"}),e.jsx("li",{children:"Report any obstacles or changing conditions"}),e.jsx("li",{children:"Check control points every 500 meters"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Start coordinates:"}),e.jsxs("p",{className:"font-medium",children:[t.coordinates[0].latitude.toFixed(6),", ",t.coordinates[0].longitude.toFixed(6)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"End coordinates:"}),e.jsxs("p",{className:"font-medium",children:[t.coordinates[t.coordinates.length-1].latitude.toFixed(6),", ",t.coordinates[t.coordinates.length-1].longitude.toFixed(6)]})]})]})]},t.id))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-green-600"}),"Evacuation Routes"]}),e.jsx("div",{className:"space-y-3",children:o.evacuationRoutes.map((t,s)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Evacuation Route ",s+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u(t.priority)}`,children:t.priority.toUpperCase()}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.capacity," people/hour"]})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg mb-3",children:[e.jsx("h5",{className:"font-medium text-green-800 mb-1",children:"Evacuation Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"Evacuate vulnerable people first (children, elderly, sick)"}),e.jsx("li",{children:"Follow the green route marked on the map"}),e.jsx("li",{children:"Maintain order and calm during movement"}),e.jsx("li",{children:"Proceed to the designated safe meeting point"}),e.jsx("li",{children:"Report anyone needing special assistance"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Meeting point:"}),e.jsxs("p",{className:"font-medium",children:[t.coordinates[t.coordinates.length-1].latitude.toFixed(6),", ",t.coordinates[t.coordinates.length-1].longitude.toFixed(6)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Evacuation capacity:"}),e.jsxs("p",{className:"font-medium",children:[t.capacity," people/hour"]})]})]})]},t.id))})]})]}),"resources"===l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600"}),"Available Water Sources"]}),e.jsx("div",{className:"space-y-3",children:o.waterSources.map((t,s)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 capitalize",children:t.type.replace("_"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${w(t.accessibility)}`,children:t.accessibility.toUpperCase()}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.distance.toFixed(1)," km"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Capacity:"}),e.jsxs("span",{className:"font-medium ml-2",children:[t.capacity.toLocaleString()," L"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Accessibility:"}),e.jsx("span",{className:`font-medium ml-2 ${w(t.accessibility)}`,children:t.accessibility})]})]}),e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-800 mb-1",children:"Access Instructions"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["river"===t.type&&"Access via forest road. Requires pump with at least 10m suction hoses.","lake"===t.type&&"Access via paved road. Marked loading point for fire engines.","reservoir"===t.type&&"Restricted access. Contact facility personnel for gate opening.","hydrant"===t.type&&"Column hydrant. Nominal pressure 5 bar. Requires standard hydrant wrench.","tank"===t.type&&"Elevated tank. Access via service ladder. Manual opening valve."]})]})]},s))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-purple-600"}),"Civilian Areas to Protect"]}),e.jsx("div",{className:"space-y-3",children:o.civilianAreas.map((t,s)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 capitalize",children:t.type.replace("_"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u(t.evacuationPriority)}`,children:["PRIORITY ",t.evacuationPriority]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.population," people"]})]})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg mb-3",children:[e.jsx("h5",{className:"font-medium text-purple-800 mb-1",children:"Specific Instructions"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-purple-700 space-y-1",children:["residential"===t.type&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Evacuate by blocks/neighborhoods in orderly fashion"}),e.jsx("li",{children:"Prioritize buildings closest to the fire front"}),e.jsx("li",{children:"Check empty homes and mark them"})]}),"hospital"===t.type&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Coordinate with hospital medical director"}),e.jsx("li",{children:"Prioritize critical patients for transfer"}),e.jsx("li",{children:"Establish field hospital if necessary"})]}),"veterinary"===t.type&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Coordinate with veterinary staff"}),e.jsx("li",{children:"Prioritize evacuation of animals by condition"}),e.jsx("li",{children:"Use special carriers and cages"})]}),"school"===t.type&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Contact school administration"}),e.jsx("li",{children:"Evacuate by classrooms maintaining groups"}),e.jsx("li",{children:"Conduct headcount at meeting point"})]}),"commercial"===t.type&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Coordinate with security managers"}),e.jsx("li",{children:"Use marked emergency exits"}),e.jsx("li",{children:"Evacuate by floors in staggered manner"})]})]})]}),t.specialNeeds.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Special needs:"}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.specialNeeds.join(", ")})]})]},s))})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"ðŸ“Š Resource Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[o.waterSources.reduce((e,t)=>e+t.capacity,0).toLocaleString(),"L"]}),e.jsx("div",{className:"text-green-700",children:"Total Water"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.civilianAreas.reduce((e,t)=>e+t.population,0).toLocaleString()}),e.jsx("div",{className:"text-blue-700",children:"Population"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:o.entryRoutes.length+o.evacuationRoutes.length}),e.jsx("div",{className:"text-orange-700",children:"Total Routes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:o.criticalZones.length}),e.jsx("div",{className:"text-purple-700",children:"Critical Zones"})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"}),"Responsible AI - System Transparency"]}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Fairness:"})," Plan specifically adapted for ",x(r.type)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Transparency:"})," Decisions based on verifiable satellite data and auditable algorithms"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Privacy:"})," Location data anonymized and protected according to GDPR"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Security:"})," Recommendations validated by international emergency protocols"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Accountability:"})," System supervised by certified emergency professionals"]})]})]})]})};const T=new class{azureFunctionsUrl="https://emergency-functions.azurewebsites.net/api";nasaFirmsApiKey={}.VITE_NASA_FIRMS_API_KEY||"";azureMLEndpoint="https://emergency-ml.azureml.net/api/v1/service";azureOpenAIEndpoint={}.VITE_AZURE_OPENAI_ENDPOINT||"";azureOpenAIKey={}.VITE_AZURE_OPENAI_KEY||"";constructor(){this.initializeAzureServices()}async initializeAzureServices(){}async detectActiveFires(e){try{const t=e.polygon.map(e=>e.latitude),s=e.polygon.map(e=>e.longitude),a=[Math.min(...s),Math.min(...t),Math.max(...s),Math.max(...t)];this.nasaFirmsApiKey;return await this.simulateNASAFIRMSData(a,e)}catch(t){return[]}}async performComprehensiveAnalysis(e,t,s){try{const[a,i,r,l,d]=await Promise.all([this.calculateFireMagnitude(e,t),this.calculateDangerScore(e,t),this.predictFireSpread(e,t),this.generateTacticalPlan(e,t,s),this.assessDataQuality(e,t)]);return{magnitudeScore:a,dangerScore:i,spreadPrediction:r,tacticalPlan:l,dataQuality:d}}catch(a){throw a}}async calculateFireMagnitude(e,t){let s=0;const a=Math.min(40,(e.brightness-300)/10);s+=Math.max(0,a);s+=Math.min(30,5*e.size);s+=.2*await this.getWeatherRiskScore(e.location);return s+=.1*await this.getVegetationDryness(e.location),Math.min(100,Math.max(0,s))}async calculateDangerScore(e,t){let s=0;s+=.4*await this.getPopulationRisk(e.location,t);s+=.3*await this.getInfrastructureRisk(e.location,t);s+=.2*await this.getEconomicRisk(e.location,t);return s+=.1*await this.getEnvironmentalRisk(e.location,t),Math.min(100,Math.max(0,s))}async predictFireSpread(e,t){const s=await this.getCurrentWeather(e.location);let a=2;a+=.3*(s.windSpeed||10),a+=.02*(100-(s.humidity||50)),a+=.1*((s.temperature||25)-20);const i=.06*a,r=Math.PI*Math.pow(24*i,2),l=Math.PI*Math.pow(72*i,2);return{direction:s.windDirection||180,speed:i,area24h:r,area72h:l,confidence:.85}}async generateTacticalPlan(e,t,s){const a=e.location;switch(s.type){case"firefighters":return this.generateFirefighterPlan(a,t);case"medical":return this.generateMedicalPlan(a,t);case"police":return this.generatePolicePlan(a,t);case"civil_protection":return this.generateCivilProtectionPlan(a,t);default:return this.generateGenericPlan(a,t)}}async generateFirefighterPlan(e,t){return{primaryStrategy:"Direct attack with containment lines",entryRoutes:[{id:"entry_1",coordinates:[e,{latitude:e.latitude+.01,longitude:e.longitude}],difficulty:"moderate",estimatedTime:15}],evacuationRoutes:[{id:"evac_1",coordinates:[e,{latitude:e.latitude-.02,longitude:e.longitude}],capacity:500,priority:"high"},{id:"evac_2",coordinates:[e,{latitude:e.latitude-.01,longitude:e.longitude-.02}],capacity:300,priority:"medium"},{id:"evac_3",coordinates:[e,{latitude:e.latitude+.01,longitude:e.longitude-.02}],capacity:200,priority:"low"}],criticalZones:[{type:"suppression",location:e,priority:10,description:"Fire head - priority attack"}],waterSources:await this.findNearbyWaterSources(e),civilianAreas:await this.findCivilianAreas(e)}}async generateMedicalPlan(e,t){return{primaryStrategy:"Establishment of advanced medical posts and medical evacuation routes",entryRoutes:[{id:"medical_entry_1",coordinates:[{latitude:e.latitude-.05,longitude:e.longitude},{latitude:e.latitude-.02,longitude:e.longitude}],difficulty:"easy",estimatedTime:10}],evacuationRoutes:[{id:"medical_evac_1",coordinates:[e,{latitude:e.latitude-.03,longitude:e.longitude+.02}],capacity:200,priority:"immediate"},{id:"medical_evac_2",coordinates:[e,{latitude:e.latitude-.02,longitude:e.longitude-.03}],capacity:150,priority:"high"},{id:"medical_evac_3",coordinates:[e,{latitude:e.latitude+.03,longitude:e.longitude-.01}],capacity:100,priority:"medium"}],criticalZones:[{type:"evacuation",location:{latitude:e.latitude-.01,longitude:e.longitude},priority:9,description:"Triage and stabilization zone"}],waterSources:[],civilianAreas:await this.findCivilianAreas(e,"medical_priority")}}async generatePolicePlan(e,t){return{primaryStrategy:"Perimeter control and civilian evacuation management",entryRoutes:[{id:"police_entry_1",coordinates:[{latitude:e.latitude-.03,longitude:e.longitude-.02},{latitude:e.latitude-.01,longitude:e.longitude-.01}],difficulty:"easy",estimatedTime:8}],evacuationRoutes:[{id:"police_evac_1",coordinates:[e,{latitude:e.latitude-.04,longitude:e.longitude}],capacity:1e3,priority:"high"},{id:"police_evac_2",coordinates:[e,{latitude:e.latitude-.03,longitude:e.longitude-.03}],capacity:800,priority:"medium"},{id:"police_evac_3",coordinates:[e,{latitude:e.latitude+.02,longitude:e.longitude-.04}],capacity:600,priority:"low"}],criticalZones:[{type:"protection",location:{latitude:e.latitude-.02,longitude:e.longitude},priority:8,description:"Evacuation control point"}],waterSources:[],civilianAreas:await this.findCivilianAreas(e,"evacuation_priority")}}async generateCivilProtectionPlan(e,t){return{primaryStrategy:"Interagency coordination and comprehensive emergency management",entryRoutes:[{id:"coord_entry_1",coordinates:[{latitude:e.latitude-.02,longitude:e.longitude-.03},{latitude:e.latitude-.01,longitude:e.longitude-.01}],difficulty:"easy",estimatedTime:12}],evacuationRoutes:[{id:"coord_evac_1",coordinates:[e,{latitude:e.latitude-.05,longitude:e.longitude+.02}],capacity:800,priority:"high"},{id:"coord_evac_2",coordinates:[e,{latitude:e.latitude-.04,longitude:e.longitude-.03}],capacity:700,priority:"medium"},{id:"coord_evac_3",coordinates:[e,{latitude:e.latitude+.03,longitude:e.longitude-.04}],capacity:500,priority:"low"}],criticalZones:[{type:"protection",location:{latitude:e.latitude-.03,longitude:e.longitude},priority:9,description:"Emergency coordination center"}],waterSources:await this.findNearbyWaterSources(e),civilianAreas:await this.findCivilianAreas(e,"comprehensive")}}generateGenericPlan(e,t){return this.generateCivilProtectionPlan(e,t)}async simulateNASAFIRMSData(e,t){const s=[],a="critical"===t.priority?.8:"high"===t.priority?.6:"medium"===t.priority?.3:.1;if(Math.random()<a){const t=Math.floor(3*Math.random())+1;for(let a=0;a<t;a++)s.push({latitude:e[1]+Math.random()*(e[3]-e[1]),longitude:e[0]+Math.random()*(e[2]-e[0]),confidence:60+40*Math.random(),brightness:320+180*Math.random(),size:.5+5*Math.random(),satellite:Math.random()>.5?"VIIRS":"MODIS",detectionTime:(new Date).toISOString()})}return s}async getWeatherRiskScore(e){return 15+10*Math.random()}async getVegetationDryness(e){return 5+5*Math.random()}async getPopulationRisk(e,t){return(t.area>10?60:t.area>5?40:20)+20*Math.random()}async getInfrastructureRisk(e,t){return 30+40*Math.random()}async getEconomicRisk(e,t){return 25+35*Math.random()}async getEnvironmentalRisk(e,t){return 20+30*Math.random()}async getCurrentWeather(e){return{windSpeed:10+20*Math.random(),windDirection:360*Math.random(),humidity:30+40*Math.random(),temperature:20+20*Math.random()}}async findNearbyWaterSources(e){return[{type:"river",location:{latitude:e.latitude+.02,longitude:e.longitude+.01},capacity:1e6,accessibility:"good",distance:2.3},{type:"reservoir",location:{latitude:e.latitude-.01,longitude:e.longitude+.03},capacity:5e5,accessibility:"excellent",distance:3.1}]}async findCivilianAreas(e,t){const s=[{type:"residential",location:{latitude:e.latitude-.01,longitude:e.longitude-.02},population:1200,evacuationPriority:7,specialNeeds:["Elderly residents","Limited mobility access"]},{type:"hospital",location:{latitude:e.latitude-.02,longitude:e.longitude+.01},population:450,evacuationPriority:10,specialNeeds:["Critical patients","Medical equipment","Specialized transport"]},{type:"school",location:{latitude:e.latitude+.01,longitude:e.longitude-.01},population:800,evacuationPriority:9,specialNeeds:["Children","Organized evacuation","Parent notification"]},{type:"veterinary",location:{latitude:e.latitude+.015,longitude:e.longitude+.01},population:120,evacuationPriority:8,specialNeeds:["Animal patients","Special carriers","Sedation equipment"]}];return"medical_priority"===t?s.filter(e=>"hospital"===e.type||e.specialNeeds.length>0):"evacuation_priority"===t?s.sort((e,t)=>t.evacuationPriority-e.evacuationPriority):s}async assessDataQuality(e,t){return{satelliteData:.92,weatherData:.88,infrastructureData:.75,overallConfidence:.85}}getServiceStatus(){return{nasaFirmsConfigured:!!this.nasaFirmsApiKey,azureMLConfigured:!0,azureOpenAIConfigured:!!this.azureOpenAIEndpoint,azureFunctionsConfigured:!0,provider:"Azure AI + NASA FIRMS"}}},L=({organization:t,monitoringZones:s})=>{const[i,r]=a.useState([]),[l,d]=a.useState(null),[n,c]=a.useState(!0),[m,x]=a.useState(new Date);a.useEffect(()=>{h();const e=setInterval(()=>{u()},3e4);return()=>clearInterval(e)},[s]);const h=async()=>{await u()},u=async()=>{if(n)try{for(const e of s){const t=await T.detectActiveFires(e);for(const s of t){if(!i.find(e=>e.fireData.location.latitude===s.latitude&&e.fireData.location.longitude===s.longitude)){const t={id:`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,zone:e,fireData:{location:{latitude:s.latitude,longitude:s.longitude},confidence:s.confidence,brightness:s.brightness,size:s.size,detectionTime:(new Date).toISOString(),satellite:s.satellite},analysis:{magnitudeScore:0,dangerScore:0,spreadPrediction:null,tacticalPlan:null},status:"new"};r(e=>[...e,t]),p(t)}}}x(new Date)}catch(e){}},p=async e=>{try{r(t=>t.map(t=>t.id===e.id?{...t,status:"analyzing"}:t));const s=await T.performComprehensiveAnalysis(e.fireData,e.zone,t);r(t=>t.map(t=>t.id===e.id?{...t,analysis:s,status:"ready"}:t))}catch(s){}},j=e=>{switch(e){case"new":return"bg-blue-100 text-blue-800";case"analyzing":return"bg-yellow-100 text-yellow-800";case"ready":return"bg-green-100 text-green-800";case"responding":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b mb-4",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3 md:py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 md:gap-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg md:text-2xl font-bold text-gray-900",children:["Command Center - ",t.name]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-xs md:text-sm text-gray-600",children:[e.jsxs("span",{children:["Type: ",t.type]}),e.jsx("span",{className:"hidden md:inline",children:"â€¢"}),e.jsxs("span",{children:["Zones: ",s.length]}),e.jsx("span",{className:"hidden md:inline",children:"â€¢"}),e.jsxs("span",{children:["Alerts: ",i.length]}),e.jsx("span",{className:"hidden md:inline",children:"â€¢"}),e.jsxs("span",{className:"flex items-center gap-1 "+(n?"text-green-600":"text-red-600"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+(n?"bg-green-500":"bg-red-500")}),n?"Active Monitoring":"Monitoring Paused"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 mt-2 md:mt-0",children:[e.jsxs("span",{className:"text-xs md:text-sm text-gray-500 hidden md:inline",children:["Last update: ",m.toLocaleTimeString()]}),e.jsx("button",{onClick:()=>c(!n),className:"px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-xs md:text-sm font-medium "+(n?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:n?"Pause":"Resume"})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-3 md:p-4",children:[e.jsxs("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 md:h-5 md:w-5 text-red-600"}),"Fire Alerts"]}),0===i.length?e.jsxs("div",{className:"text-center py-6 md:py-8",children:[e.jsx(o,{className:"h-8 w-8 md:h-12 md:w-12 text-gray-400 mx-auto mb-3 md:mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm md:text-base",children:"No active alerts"}),e.jsxs("p",{className:"text-xs md:text-sm text-gray-400",children:["The system is monitoring ",s.length," zones"]})]}):e.jsx("div",{className:"space-y-2 md:space-y-3",children:i.map(t=>{const s=(a=t.analysis.magnitudeScore)>=80?{level:"Extreme",color:"text-red-600"}:a>=60?{level:"High",color:"text-orange-600"}:a>=40?{level:"Medium",color:"text-yellow-600"}:{level:"Low",color:"text-green-600"};var a;const i=(e=>e>=80?{level:"Critical",color:"text-red-600"}:e>=60?{level:"High",color:"text-orange-600"}:e>=40?{level:"Medium",color:"text-yellow-600"}:{level:"Low",color:"text-green-600"})(t.analysis.dangerScore);return e.jsxs("div",{onClick:()=>d(t),className:"p-3 md:p-4 border rounded-lg cursor-pointer transition-colors "+(l?.id===t.id?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 md:mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:t.zone.name}),e.jsx("span",{className:`px-2 py-0.5 md:py-1 rounded-full text-xs font-medium ${j(t.status)}`,children:t.status.toUpperCase()})]}),e.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Detection:"}),e.jsx("span",{className:"font-medium",children:new Date(t.fireData.detectionTime).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Satellite:"}),e.jsx("span",{className:"font-medium",children:t.fireData.satellite})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Confidence:"}),e.jsxs("span",{className:"font-medium",children:[t.fireData.confidence,"%"]})]}),"ready"===t.status&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Magnitude:"}),e.jsxs("span",{className:`font-medium ${s.color}`,children:[s.level," (",t.analysis.magnitudeScore.toFixed(2),"/100)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Danger:"}),e.jsxs("span",{className:`font-medium ${i.color}`,children:[i.level," (",t.analysis.dangerScore.toFixed(2),"/100)"]})]})]})]}),"analyzing"===t.status&&e.jsxs("div",{className:"mt-2 md:mt-3 flex items-center gap-2 text-yellow-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 md:h-4 md:w-4 border-b-2 border-yellow-600"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Analyzing with Azure AI..."})]})]},t.id)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-3 md:p-4",children:[e.jsxs("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 md:h-5 md:w-5 text-blue-600"}),"Monitored Zones"]}),e.jsx("div",{className:"space-y-2",children:s.map(t=>e.jsxs("div",{className:"p-2 md:p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-sm md:text-base",children:t.name}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium "+("critical"===t.priority?"bg-red-100 text-red-800":"high"===t.priority?"bg-orange-100 text-orange-800":"medium"===t.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:t.priority.toUpperCase()})]}),e.jsxs("div",{className:"text-xs md:text-sm text-gray-600 mt-1",children:[t.area.toFixed(2)," kmÂ² â€¢ ",t.polygon.length," points"]})]},t.id))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-3 md:p-4",children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4",children:"Real-Time Situation Map"}),e.jsx(R,{monitoringZones:s,activeAlerts:i,onAlertSelect:d})]}),l&&"ready"===l.status&&e.jsx(k,{alert:l}),l&&"ready"===l.status&&l.analysis.tacticalPlan&&e.jsx(_,{alert:l,organization:t})]})]})})]})};export{L as default};
